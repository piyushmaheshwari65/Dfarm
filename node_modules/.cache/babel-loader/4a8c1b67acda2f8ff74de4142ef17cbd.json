{"ast":null,"code":"'use strict';\n\nvar defined = require('./utils').defined;\n\nvar varint = require('varint');\n\nfunction compileEncode(m, resolve, enc, oneofs, encodingLength) {\n  var oneofsKeys = Object.keys(oneofs);\n  var encLength = enc.length;\n  var ints = {};\n\n  for (var i = 0; i < encLength; i++) {\n    ints[i] = {\n      p: varint.encode(m.fields[i].tag << 3 | 2),\n      h: varint.encode(m.fields[i].tag << 3 | enc[i].type)\n    };\n    var field = m.fields[i];\n    m.fields[i].packed = field.repeated && field.options && field.options.packed && field.options.packed !== 'false';\n  }\n\n  function encodeField(buf, view, offset, h, e, packed, innerVal) {\n    var j = 0;\n\n    if (!packed) {\n      for (j = 0; j < h.length; j++) {\n        buf[offset++] = h[j];\n      }\n    }\n\n    if (e.message) {\n      varint.encode(e.encodingLength(innerVal), buf, offset);\n      offset += varint.encode.bytes;\n    }\n\n    e.encode(innerVal, buf, view, offset);\n    return offset + e.encode.bytes;\n  }\n\n  return function encode(obj, buf, view) {\n    var offset = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n\n    if (buf == null) {\n      buf = new Uint8Array(encodingLength(obj));\n    }\n\n    if (view == null) {\n      view = new DataView(buf.buffer, buf.byteOffset, buf.byteLength);\n    }\n\n    var oldOffset = offset;\n    var objKeys = Object.keys(obj);\n    var i = 0; // oneof checks\n\n    var match = false;\n\n    for (i = 0; i < oneofsKeys.length; i++) {\n      var name = oneofsKeys[i];\n      var prop = oneofs[i];\n\n      if (objKeys.indexOf(prop) > -1) {\n        if (match) {\n          throw new Error('only one of the properties defined in oneof ' + name + ' can be set');\n        }\n\n        match = true;\n      }\n    }\n\n    for (i = 0; i < encLength; i++) {\n      var e = enc[i];\n      var _field = m.fields[i]; // was f\n\n      var val = obj[_field.name];\n      var j = 0;\n\n      if (!defined(val)) {\n        if (_field.required) {\n          throw new Error(_field.name + ' is required');\n        }\n\n        continue;\n      }\n\n      var p = ints[i].p;\n      var h = ints[i].h;\n      var packed = _field.packed;\n\n      if (_field.map) {\n        var tmp = Object.keys(val);\n\n        for (j = 0; j < tmp.length; j++) {\n          tmp[j] = {\n            key: tmp[j],\n            value: val[tmp[j]]\n          };\n        }\n\n        val = tmp;\n      }\n\n      if (packed) {\n        var packedLen = 0;\n\n        for (j = 0; j < val.length; j++) {\n          if (!Object.prototype.hasOwnProperty.call(val, j)) {\n            continue;\n          }\n\n          packedLen += e.encodingLength(val[j]);\n        }\n\n        if (packedLen) {\n          for (j = 0; j < h.length; j++) {\n            buf[offset++] = p[j];\n          }\n\n          varint.encode(packedLen, buf, offset);\n          offset += varint.encode.bytes;\n        }\n      }\n\n      if (_field.repeated) {\n        var innerVal = void 0;\n\n        for (j = 0; j < val.length; j++) {\n          innerVal = val[j];\n\n          if (!defined(innerVal)) {\n            continue;\n          }\n\n          offset = encodeField(buf, view, offset, h, e, packed, innerVal);\n        }\n      } else {\n        offset = encodeField(buf, view, offset, h, e, packed, val);\n      }\n    }\n\n    encode.bytes = offset - oldOffset;\n    return buf;\n  };\n}\n\nmodule.exports = compileEncode;","map":{"version":3,"sources":["/home/piyush/Documents/GitHub/Dfarm/node_modules/protons/src/compile/encode.js"],"names":["defined","require","varint","compileEncode","m","resolve","enc","oneofs","encodingLength","oneofsKeys","Object","keys","encLength","length","ints","i","p","encode","fields","tag","h","type","field","packed","repeated","options","encodeField","buf","view","offset","e","innerVal","j","message","bytes","obj","Uint8Array","DataView","buffer","byteOffset","byteLength","oldOffset","objKeys","match","name","prop","indexOf","Error","val","required","map","tmp","key","value","packedLen","prototype","hasOwnProperty","call","module","exports"],"mappings":"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","sourcesContent":["'use strict'\n\nvar defined = require('./utils').defined\nvar varint = require('varint')\n\nfunction compileEncode (m, resolve, enc, oneofs, encodingLength) {\n  const oneofsKeys = Object.keys(oneofs)\n  const encLength = enc.length\n  const ints = {}\n  for (let i = 0; i < encLength; i++) {\n    ints[i] = {\n      p: varint.encode(m.fields[i].tag << 3 | 2),\n      h: varint.encode(m.fields[i].tag << 3 | enc[i].type)\n    }\n\n    const field = m.fields[i]\n    m.fields[i].packed = field.repeated && field.options && field.options.packed && field.options.packed !== 'false'\n  }\n\n  function encodeField (buf, view, offset, h, e, packed, innerVal) {\n    let j = 0\n    if (!packed) {\n      for (j = 0; j < h.length; j++) {\n        buf[offset++] = h[j]\n      }\n    }\n\n    if (e.message) {\n      varint.encode(e.encodingLength(innerVal), buf, offset)\n      offset += varint.encode.bytes\n    }\n\n    e.encode(innerVal, buf, view, offset)\n\n    return offset + e.encode.bytes\n  }\n\n  return function encode (obj, buf, view, offset = 0) {\n    if (buf == null) {\n      buf = new Uint8Array(encodingLength(obj))\n    }\n\n    if (view == null) {\n      view = new DataView(buf.buffer, buf.byteOffset, buf.byteLength)\n    }\n\n    const oldOffset = offset\n    const objKeys = Object.keys(obj)\n    let i = 0\n\n    // oneof checks\n\n    let match = false\n    for (i = 0; i < oneofsKeys.length; i++) {\n      const name = oneofsKeys[i]\n      const prop = oneofs[i]\n      if (objKeys.indexOf(prop) > -1) {\n        if (match) {\n          throw new Error('only one of the properties defined in oneof ' + name + ' can be set')\n        }\n\n        match = true\n      }\n    }\n\n    for (i = 0; i < encLength; i++) {\n      const e = enc[i]\n      const field = m.fields[i] // was f\n      let val = obj[field.name]\n      let j = 0\n\n      if (!defined(val)) {\n        if (field.required) {\n          throw new Error(field.name + ' is required')\n        }\n        continue\n      }\n      const p = ints[i].p\n      const h = ints[i].h\n\n      const packed = field.packed\n\n      if (field.map) {\n        const tmp = Object.keys(val)\n        for (j = 0; j < tmp.length; j++) {\n          tmp[j] = {\n            key: tmp[j],\n            value: val[tmp[j]]\n          }\n        }\n        val = tmp\n      }\n\n      if (packed) {\n        let packedLen = 0\n        for (j = 0; j < val.length; j++) {\n          if (!Object.prototype.hasOwnProperty.call(val, j)) {\n            continue\n          }\n\n          packedLen += e.encodingLength(val[j])\n        }\n\n        if (packedLen) {\n          for (j = 0; j < h.length; j++) {\n            buf[offset++] = p[j]\n          }\n          varint.encode(packedLen, buf, offset)\n          offset += varint.encode.bytes\n        }\n      }\n\n      if (field.repeated) {\n        let innerVal\n        for (j = 0; j < val.length; j++) {\n          innerVal = val[j]\n          if (!defined(innerVal)) {\n            continue\n          }\n\n          offset = encodeField(buf, view, offset, h, e, packed, innerVal)\n        }\n      } else {\n        offset = encodeField(buf, view, offset, h, e, packed, val)\n      }\n    }\n\n    encode.bytes = offset - oldOffset\n    return buf\n  }\n}\n\nmodule.exports = compileEncode\n"]},"metadata":{},"sourceType":"script"}